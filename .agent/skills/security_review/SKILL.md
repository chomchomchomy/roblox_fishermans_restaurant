---
name: security-review
description: コードの脆弱性、機密情報の露出、不適切な入力処理などを自動でチェックするセキュリティ特化スキル。
---

# Security Review Skill

コードの安全性を担保し、プロジェクトをサイバーリスクや情報漏洩から守るためのガイドラインです。

## チェックリスト

### 1. 秘密情報の管理 (Secrets Management)
- **絶対NG**: `api_key = "sk-..."` のようなハードコード。
- **絶対OK**: `.env` ファイルを使用し、環境変数 `os.environ` から読み込む。
- **検証**: `git commit` 前に、`.env` が `.gitignore` に含まれているか、コード内にキーが残っていないかを `grep` で確認する。

### 2. 入力値の検証とサニタイズ (Input Validation)
- **Webスクレイピング**: 取得した文字列をそのままファイル名やDBクエリに使わず、必ず記号の置換や型チェックを行う。
- **SQL/NoSQL**: 文字列結合によるクエリ生成を避け、プレースホルダやORMを使用する。

### 3. ファイル操作の安全性 (File Operations)
- `../` を含むパスをユーザー入力から生成させない（ディレクトリトラバーサル対策）。
- 書き込み権限や実行権限を必要最小限に留める。

### 4. 依存ライブラリのチェック (Dependency Scan)
- ライブラリをインストールする際、既知の脆弱性がないか確認する（`npm audit` や `pip list --outdated`）。

### 5. デバッグ情報の削除 (Log Hygiene)
- 開発中に一時的に追加した `print(api_response)` などのログに機密情報が含まれていないか、本番反映前に確認・削除する。

## 実行フェーズへの組み込み

### 開発中: セキュアコーディング
- コードを書く際、常に「もしこの値が悪意のある文字列だったら？」を想定します。

### レビュー時: Security Scan
- `verification-loop` の一環として、以下のコマンドを（仮想的に）実行します。
  - `grep -rnE "sk-|key-|password" .` (秘密情報の検索)
  - `git status` ( `.env` が追跡対象になっていないかの確認)

## 私が意識すること
あなたのプロジェクトには、不動産データの取得（外部サイトへのアクセス）や動画生成（ローカルリソースの活用）が含まれます。
「外部へのアクセスは紳士的に（Rate Limitの遵守）」「ローカルへの保存は安全に」という2点を特に重視して行動します。
