---
name: document-pro-processor
description: PDF, XLSX, DOCX, PPTX などのオフィスファイルを構造的に解析・編集・作成するプロフェッショナルスキル。
---

# Document Pro Processor Skill

各種ドキュメント形式の内部構造を理解し、情報の抽出や正確なドキュメント生成を行います。

## 対応フォーマットとアプローチ

### 1. PDF 解析 (PDF Analysis) - Quota Optimization
- **ローカルファースト原則**: AI（Gemini等）を使う前に、必ずPythonライブラリ（`pdfplumber` や `PyPDF2`）を用いてローカル環境でテキスト抽出を試みる。
- **スマート判定**: 
    - 抽出されたテキストが一定量（例：100文字以上）あり、有意な内容である場合は、AIを使わずにそのテキストを処理する。
    - テキストが極端に少ない、または文字化けしている場合（スキャン画像や図面データ）のみ、AI（Gemini OCR）を活用する。
- **コスト意識**: 100ページのPDFをAIに投げるとクォータを数分で使い果たすため、必要なページのみを特定し、ローカル抽出とAI抽出を使い分けるハイブリッド抽出を徹底する。
- **実務活用**: 不動産販売図面からの価格・利回り・所在地情報の自動抽出。画像ベースの図面にはAIを、テキストベースの目録にはローカル抽出を使用。

### 2. Excel 操作 (XLSX Management)
- **データ更新**: `openpyxl` や `pandas` を使い、既存のシミュレーションシートに計算結果を流し込む。
- **フォーマット維持**: セルのスタイルや数式を壊さずに値を更新する。
- **レポート生成**: 複数の分析結果を1つのワークブックに集約。

### 3. Word/Markdown 連携 (DOCX & MD)
- **レポート作成**: 分析結果を構造化された Word ドキュメントとして書き出す。
- **テンプレート活用**: 決まった書式の契約書や報告書の下書きを自動作成。

### 4. PowerPoint 生成 (PPTX Generation)
- **プレゼン作成**: 投資判断用のピッチ資料や物件概要スライドの自動生成。

## 実行ワークフロー

### ステップ 1: Structure Discovery (構造把握)
- ファイルをいきなり読み取るのではなく、まず「どのような表や見出しがあるか」を把握します。

### ステップ 2: Precise Extraction (精密抽出)
- 必要な項目（例：物件名、専有面積、築年数）をターゲットにして情報を抜き出します。

### ステップ 3: Cross-Reference (照合)
- 抽出したデータが論理的に正しいか（例：表面利回り = 賃料収入 / 価格 と一致するか）をチェックします。

## ツール活用
必要に応じて、以下のPythonライブラリをインストール・活用してタスクを完遂します：
- `PyPDF2`, `pdfplumber` (PDF)
- `openpyxl`, `pandas` (Excel)
- `python-docx` (Word)
- `python-pptx` (PowerPoint)

## 私が意識すること
「ファイルが読み込めません」で終わらせず、「内部構造をダンプして解析する」「ライブラリを使って強引にでも構造化する」という粘り強いアプローチを取ります。
