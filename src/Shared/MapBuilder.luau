-- MapBuilder.luau
-- ğŸŒŠ [World Builder] æœ€çµ‚å®‰å®šç‰ˆï¼šç„šãç«ã¨æµ·è¾ºã®å¢ƒç•Œç·š
local MapBuilder = {}
local terrain = workspace.Terrain
local Players = game:GetService("Players")

function MapBuilder.buildBase()
    terrain:Clear()
    -- é€ãé€šã‚‹æµ·
    terrain:FillBlock(CFrame.new(0, -95, 0), Vector3.new(4000, 180, 4000), Enum.Material.Water)
    -- å¹³ã‚‰ãªç ‚å³¶ï¼ˆåŠå¾„150ï¼‰
    terrain:FillCylinder(CFrame.new(0, -4, 0), 8, 150, Enum.Material.Sand)
    
    -- ã‚´ãƒŸæƒé™¤
    for _, obj in pairs(workspace:GetChildren()) do
        if obj.Name == "Baseplate" or obj.Name == "Sea" or (obj:IsA("BasePart") and obj.Size.X > 200) then
            obj:Destroy()
        end
    end
end

function MapBuilder.buildFoodStand()
    if workspace:FindFirstChild("FoodStand") then workspace.FoodStand:Destroy() end
    local folder = Instance.new("Folder", workspace); folder.Name = "FoodStand"
    local bPos = Vector3.new(40, 1.5, 90) -- ç„šãç«
    local bonfire = Instance.new("Part", folder); bonfire.Name = "Bonfire"; bonfire.Size = Vector3.new(8, 2, 8); bonfire.Position = bPos
    bonfire.Color = Color3.fromRGB(70, 50, 30); bonfire.Material = Enum.Material.Slate; bonfire.Anchored = true
    Instance.new("Fire", bonfire).Size = 10
    
    -- ã‚·ã‚§ãƒ•
    local chef = workspace:FindFirstChild("Chef") or Players:CreateHumanoidModelFromUserId(524027791)
    chef.Name = "Chef"; chef.Parent = workspace
    chef:PivotTo(CFrame.new(bPos + Vector3.new(12, 0, 0)))
    for _, p in pairs(chef:GetDescendants()) do if p:IsA("BasePart") then p.Anchored = true end end
end

function MapBuilder.buildAll()
    MapBuilder.buildBase()
    MapBuilder.buildFoodStand()
    
    -- â˜…ç©¶æ¥µã®å‡ºç¾åœ°ç‚¹ï¼ˆç„šãç«ã¨æµ·ã®ä¸­é–“ï¼‰
    local spawn = workspace:FindFirstChild("SpawnLocation") or Instance.new("SpawnLocation", workspace)
    spawn.Name = "SpawnLocation"
    -- ç„šãç«(Z=90) ã¨ æµ·è¾º(Z=150) ã®ä¸­é–“ = Z=120
    spawn.Position = Vector3.new(40, 5, 120) 
    spawn.Size = Vector3.new(12, 1, 12)
    spawn.Anchored = true
    spawn.Transparency = 0.5
    
    warn("âœ¨ [World] ç„šãç«ã¨æµ·ã®ä¸­é–“ã«ã‚¹ãƒãƒ¼ãƒ³åœ°ç‚¹ã‚’è¨­å®šã—ã¾ã—ãŸã€‚")
end

return MapBuilder
