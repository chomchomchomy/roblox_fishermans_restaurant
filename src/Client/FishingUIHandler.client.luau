-- [Rojoç®¡ç†] ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯VS Codeï¼ˆAntigravityï¼‰ã§ç·¨é›†ã—ã¦ã­ï¼
-- StarterGui > FishingUIHandler (LocalScript)

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local fishingEvent = ReplicatedStorage:WaitForChild("FishingEvent")
local player = game.Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°
-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°
local function showCatchMessage(itemName, price, imageId, weightStr)
	print("ğŸï¸ æ¼”å‡ºã‚¹ã‚¿ãƒ¼ãƒˆï¼ é­š: " .. itemName .. " (" .. weightStr .. ")")
	
	local screenGui = playerGui:FindFirstChild("CatchGui") or Instance.new("ScreenGui")
	screenGui.Name = "CatchGui"
	screenGui.ResetOnSpawn = false
	screenGui.Parent = playerGui

	-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒŠ
	local container = Instance.new("Frame")
	container.Size = UDim2.new(0, 400, 0, 400)
	container.Position = UDim2.new(0.5, -200, 0.4, 0)
	container.AnchorPoint = Vector2.new(0.5, 0.5)
	container.BackgroundTransparency = 1
	container.Parent = screenGui

	-- ãŠé­šã®ç”»åƒ
	local fishImage = Instance.new("ImageLabel")
	fishImage.Size = UDim2.new(0, 250, 0, 250)
	fishImage.Position = UDim2.new(0.5, -125, 0, 0)
	fishImage.Image = imageId or "rbxassetid://16024926500"
	fishImage.BackgroundTransparency = 1
	fishImage.ZIndex = 12
	fishImage.Parent = container

	-- åå‰ãƒ‘ãƒãƒ«
	local nameLabel = Instance.new("TextLabel")
	nameLabel.Size = UDim2.new(1, 0, 0, 50)
	nameLabel.Position = UDim2.new(0, 0, 0, 260)
	nameLabel.BackgroundTransparency = 0.5
	nameLabel.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
	nameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
	nameLabel.Text = itemName
	nameLabel.TextScaled = true
	nameLabel.Font = Enum.Font.LuckiestGuy
	nameLabel.ZIndex = 15
	nameLabel.Parent = container
	
	Instance.new("UICorner", nameLabel).CornerRadius = UDim.new(0, 10)

	-- é‡ã•ãƒ©ãƒ™ãƒ«
	local weightLabel = Instance.new("TextLabel")
	weightLabel.Size = UDim2.new(1, 0, 0, 30)
	weightLabel.Position = UDim2.new(0, 0, 0, 320)
	weightLabel.BackgroundTransparency = 1
	weightLabel.TextColor3 = Color3.fromRGB(150, 255, 150)
	weightLabel.Text = weightStr or "0.0kg"
	weightLabel.TextSize = 24
	weightLabel.Font = Enum.Font.GothamBold
	weightLabel.ZIndex = 15
	weightLabel.Parent = container

	-- ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼šãƒ‰ã‚«ãƒ³ã¨å¤§ããå¼¾ã‚€ï¼
	fishImage.Size = UDim2.new(0, 0, 0, 0)
	fishImage:TweenSize(UDim2.new(0, 250, 0, 250), "Out", "Back", 0.5)

	task.wait(3)
	container:Destroy()
	print("ğŸ§¹ æ¼”å‡ºçµ‚äº†ï¼šç”»é¢ã‚’ãŠæƒé™¤ã—ã¾ã—ãŸ")
end

-- â˜…NEWï¼šãƒ’ãƒƒãƒˆã®åˆå›³ã€Œï¼ã€ã¨æŒ‡ç¤ºã‚’ç”»é¢ã«å‡ºã™é­”æ³•
local function showHitEffect()
	print("ğŸ“¢ ãƒ’ãƒƒãƒˆæ¼”å‡ºï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚¯ãƒªãƒƒã‚¯æŒ‡ç¤ºã‚’å‡ºã—ã¾ã™")
	local screenGui = playerGui:FindFirstChild("CatchGui") or Instance.new("ScreenGui")
	screenGui.Name = "CatchGui"
	screenGui.Parent = playerGui

	-- ãƒ‡ã‚«ã„ã€Œï¼ã€
	local hitLabel = Instance.new("TextLabel")
	hitLabel.Size = UDim2.new(0.5, 0, 0.4, 0)
	hitLabel.Position = UDim2.new(0.25, 0, 0.1, 0)
	hitLabel.BackgroundTransparency = 1
	hitLabel.Text = "â—"
	hitLabel.TextScaled = true
	hitLabel.Font = Enum.Font.GothamBold
	hitLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
	hitLabel.Rotation = -10
	hitLabel.ZIndex = 20
	hitLabel.Parent = screenGui

	-- â˜…æŒ‡ç¤ºãƒ†ã‚­ã‚¹ãƒˆï¼šã€Œã‚¯ãƒªãƒƒã‚¯ï¼ã€
	local clickLabel = Instance.new("TextLabel")
	clickLabel.Size = UDim2.new(0.4, 0, 0.2, 0)
	clickLabel.Position = UDim2.new(0.3, 0, 0.45, 0)
	clickLabel.BackgroundTransparency = 1
	clickLabel.Text = "CLICK!" -- ã¾ãŸã¯ã€Œã‚¯ãƒªãƒƒã‚¯ã—ã¦ï¼ã€
	clickLabel.TextScaled = true
	clickLabel.Font = Enum.Font.LuckiestGuy -- å‹¢ã„ã®ã‚ã‚‹ãƒ•ã‚©ãƒ³ãƒˆ
	clickLabel.TextColor3 = Color3.fromRGB(255, 255, 0) -- é»„è‰²
	clickLabel.ZIndex = 21
	clickLabel.Parent = screenGui
	
	-- æ¼”å‡ºï¼šç‚¹æ»…ã•ã›ã¦ç›®ç«‹ãŸã›ã‚‹ï¼
	task.spawn(function()
		for i = 1, 6 do
			clickLabel.Visible = not clickLabel.Visible
			task.wait(0.1)
		end
		clickLabel.Visible = true
	end)

	-- ç«¿ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ å´ã§è¨­å®šã—ãŸæ™‚é–“ï¼ˆ2.5ç§’å¼±ï¼‰å¾…ã£ã¦ã‹ã‚‰æ¶ˆã™
	task.wait(1.5) -- æŒ‡ç¤ºã¯ãƒ‘ãƒƒã¨æ¶ˆãˆã¦ã„ã„
	hitLabel:Destroy()
	clickLabel:Destroy()
end

-- ãƒ­ãƒ¼ã‚«ãƒ«é€šçŸ¥ï¼ˆä»–ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆã‹ã‚‰ã®å‘¼ã³å‡ºã—ï¼‰ã‚’å—ã‘å–ã‚‹
local localNotice = ReplicatedStorage:FindFirstChild("LocalNotice")
if not localNotice then
	localNotice = Instance.new("BindableEvent")
	localNotice.Name = "LocalNotice"
	localNotice.Parent = ReplicatedStorage
end

local function showBagFullWarning()
	print("ãƒãƒƒã‚°ãŒã„ã£ã±ã„ã§ã™ï¼")
	-- ãƒãƒƒã‚°æº€æ¯æ™‚ã®è­¦å‘Šè¡¨ç¤ºï¼ˆã‚‚ã£ã¨ç›®ç«‹ã¤ã‚ˆã†ã«ï¼ï¼‰
	local screenGui = playerGui:FindFirstChild("CatchGui") or Instance.new("ScreenGui")
	screenGui.Name = "CatchGui"
	screenGui.Parent = playerGui

	local container = Instance.new("Frame")
	container.Size = UDim2.new(0, 400, 0, 80)
	container.Position = UDim2.new(0.5, -200, 0.3, 0)
	container.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
	container.BorderSizePixel = 0
	container.Parent = screenGui

	local uiCorner = Instance.new("UICorner")
	uiCorner.CornerRadius = UDim.new(0, 12)
	uiCorner.Parent = container

	local warnLabel = Instance.new("TextLabel")
	warnLabel.Size = UDim2.new(1, 0, 1, 0)
	warnLabel.BackgroundTransparency = 1
	warnLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
	warnLabel.Text = "ğŸš¨ ãƒãƒƒã‚°ãŒã„ã£ã±ã„ã§ã™ï¼å±‹å°ã§å£²ã£ã¦ãã¾ã—ã‚‡ã†ï¼"
	warnLabel.TextScaled = true
	warnLabel.Font = Enum.Font.GothamBlack
	warnLabel.Parent = container
	
	-- ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼šãƒ‘ãƒ«ã‚¹ï¼ˆãƒ‰ã‚¯ãƒ³ãƒ‰ã‚¯ãƒ³ã¨å‹•ãï¼‰
	container:TweenSize(UDim2.new(0, 420, 0, 90), "Out", "Quad", 0.2, true, function()
		container:TweenSize(UDim2.new(0, 400, 0, 80), "Out", "Quad", 0.2, true)
	end)

	task.wait(2.5)
	container:Destroy()
end

localNotice.Event:Connect(function(msg)
	if msg == "BAG_FULL" then
		showBagFullWarning()
	end
end)

-- ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®é€šçŸ¥ã‚’å—ã‘å–ã‚‹
fishingEvent.OnClientEvent:Connect(function(itemName, price, imageId, weightStr)
	if itemName == "HIT" then
		showHitEffect()
	elseif itemName == "BAG_FULL" then
		showBagFullWarning()
	elseif itemName == "SELL_RESULTS" then
		local totalMoney = price -- ç¬¬2å¼•æ•°ã‚’priceã¨ã—ã¦å—ã‘å–ã£ã¦ã„ã‚‹
		local count = imageId -- ç¬¬3å¼•æ•°ã‚’imageId(count)ã¨ã—ã¦å—ã‘å–ã£ã¦ã„ã‚‹
		
		print("ğŸ’° å£²å´å®Œäº†: " .. totalMoney .. "å††")
		
		-- å£²å´æˆåŠŸã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆè¡¨ç¤º
		local screenGui = playerGui:FindFirstChild("CatchGui") or Instance.new("ScreenGui")
		screenGui.Name = "CatchGui"
		screenGui.Parent = playerGui

		local sellLabel = Instance.new("TextLabel")
		sellLabel.Size = UDim2.new(0, 400, 0, 50)
		sellLabel.Position = UDim2.new(0.5, -200, 0.45, 0)
		sellLabel.BackgroundTransparency = 1
		sellLabel.TextColor3 = Color3.fromRGB(255, 215, 0) -- ã‚´ãƒ¼ãƒ«ãƒ‰è‰²
		sellLabel.Text = "ğŸ’° +" .. totalMoney .. " Gold! (" .. count .. "åŒ¹å£²å´)"
		sellLabel.TextScaled = true
		sellLabel.Font = Enum.Font.LuckiestGuy
		sellLabel.Parent = screenGui
		
		-- ä¸Šã«ãµã‚ã£ã¨æ¶ˆãˆã¦ã„ãã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
		sellLabel:TweenPosition(UDim2.new(0.5, -200, 0.35, 0), "Out", "Quart", 1.5)
		task.spawn(function()
			for i = 0, 1, 0.05 do
				sellLabel.TextTransparency = i
				task.wait(0.075)
			end
			sellLabel:Destroy()
		end)
	else
		print("ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå—ä¿¡: " .. itemName .. " ã‚’é‡£ã‚Šã¾ã—ãŸï¼")
		showCatchMessage(itemName, price, imageId, weightStr)
	end
end)
